

## üìå PySpark Program

```python
# Import required libraries
from pyspark.sql import SparkSession

# Create Spark Session
spark = SparkSession.builder \
    .appName("Spark SQL - Select, Join, GroupBy Example") \
    .getOrCreate()

# -----------------------------
# Create Sample Structured Data
# -----------------------------

# Employee Data
employee_data = [
    (1, "Alice", "HR", 50000),
    (2, "Bob", "IT", 60000),
    (3, "Charlie", "IT", 70000),
    (4, "David", "Finance", 65000),
    (5, "Eve", "HR", 55000)
]

employee_columns = ["emp_id", "emp_name", "department", "salary"]
employees_df = spark.createDataFrame(employee_data, employee_columns)

# Department Data
department_data = [
    ("HR", "Human Resources"),
    ("IT", "Information Technology"),
    ("Finance", "Finance Department")
]

department_columns = ["department", "dept_full_name"]
departments_df = spark.createDataFrame(department_data, department_columns)

# Create Temporary Views
employees_df.createOrReplaceTempView("employees")
departments_df.createOrReplaceTempView("departments")

# 1. SELECT Query
print("=== SELECT Query Result ===")
select_query = spark.sql("""
    SELECT emp_id, emp_name, salary
    FROM employees
""")
select_query.show()

# 2. JOIN Query
print("=== JOIN Query Result ===")
join_query = spark.sql("""
    SELECT e.emp_id, e.emp_name, d.dept_full_name, e.salary
    FROM employees e
    INNER JOIN departments d
    ON e.department = d.department
""")
join_query.show()

# 3. GROUP BY Query
print("=== GROUP BY Query Result ===")
group_query = spark.sql("""
    SELECT department,
           SUM(salary) AS total_salary,
           AVG(salary) AS avg_salary
    FROM employees
    GROUP BY department
""")
group_query.show()

# Stop Spark Session
spark.stop()
```

---

## üìä Output

### 1Ô∏è‚É£ SELECT Query Result

```
+------+---------+------+
|emp_id|emp_name |salary|
+------+---------+------+
|1     |Alice    |50000 |
|2     |Bob      |60000 |
|3     |Charlie  |70000 |
|4     |David    |65000 |
|5     |Eve      |55000 |
+------+---------+------+
```

---

### 2Ô∏è‚É£ JOIN Query Result

```
+------+---------+----------------------+------+
|emp_id|emp_name |dept_full_name        |salary|
+------+---------+----------------------+------+
|1     |Alice    |Human Resources       |50000 |
|2     |Bob      |Information Technology|60000 |
|3     |Charlie  |Information Technology|70000 |
|4     |David    |Finance Department    |65000 |
|5     |Eve      |Human Resources       |55000 |
+------+---------+----------------------+------+
```

---

### 3Ô∏è‚É£ GROUP BY Query Result

```
+----------+------------+----------+
|department|total_salary|avg_salary|
+----------+------------+----------+
|HR        |105000      |52500.0   |
|IT        |130000      |65000.0   |
|Finance   |65000       |65000.0   |
+----------+------------+----------+
```
 
