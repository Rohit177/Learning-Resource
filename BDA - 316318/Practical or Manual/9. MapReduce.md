# Execute WordCount MapReduce Program
---

# 1Ô∏è‚É£ Start Hadoop (Required)

Open **Command Prompt as Administrator**.

```bat
start-dfs.cmd
start-yarn.cmd
```

Verify:

```bat
jps
```

You should see:

```
NameNode
DataNode
ResourceManager
NodeManager
```

---

# 2Ô∏è‚É£ Load a Text File into HDFS

### üîπ Create input directory in HDFS

```bat
hdfs dfs -mkdir /input
```

### üîπ Copy a text file from local system to HDFS

Example (replace path if needed):

```bat
hdfs dfs -put C:\Users\HP\Desktop\sample.txt /input
```

### üîπ Verify file in HDFS

```bat
hdfs dfs -ls /input
```

---

# 3Ô∏è‚É£ WordCount MapReduce Program (Java)

Create a file named:

```
WordCount.java
```

### ‚úÖ WordCount.java (Standard Hadoop Program)

```java
import java.io.IOException;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;

public class WordCount {

    public static class TokenizerMapper
            extends Mapper<Object, Text, Text, IntWritable> {

        private final static IntWritable one = new IntWritable(1);
        private Text word = new Text();

        public void map(Object key, Text value, Context context)
                throws IOException, InterruptedException {

            String[] words = value.toString().split("\\s+");
            for (String w : words) {
                word.set(w);
                context.write(word, one);
            }
        }
    }

    public static class IntSumReducer
            extends Reducer<Text, IntWritable, Text, IntWritable> {

        public void reduce(Text key, Iterable<IntWritable> values,
                           Context context)
                throws IOException, InterruptedException {

            int sum = 0;
            for (IntWritable val : values) {
                sum += val.get();
            }
            context.write(key, new IntWritable(sum));
        }
    }

    public static void main(String[] args) throws Exception {

        Configuration conf = new Configuration();
        Job job = Job.getInstance(conf, "word count");

        job.setJarByClass(WordCount.class);
        job.setMapperClass(TokenizerMapper.class);
        job.setReducerClass(IntSumReducer.class);

        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(IntWritable.class);

        FileInputFormat.addInputPath(job, new Path(args[0]));
        FileOutputFormat.setOutputPath(job, new Path(args[1]));

        System.exit(job.waitForCompletion(true) ? 0 : 1);
    }
}
```

---

#  4Ô∏è‚É£ Go to the folder containing `WordCount.java`

Example :

```bat
cd C:\Users\HP\Downloads
```
Verify the file exists:

```bat
dir
```

You MUST see:

```
WordCount.java
```

---

# 5Ô∏è‚É£ Compile the Java program

Run **this exact command**:

```bat
javac -classpath "%HADOOP_HOME%\share\hadoop\common\*;%HADOOP_HOME%\share\hadoop\common\lib\*;%HADOOP_HOME%\share\hadoop\mapreduce\*;%HADOOP_HOME%\share\hadoop\mapreduce\lib\*;%HADOOP_HOME%\share\hadoop\hdfs\*;%HADOOP_HOME%\share\hadoop\hdfs\lib\*;%HADOOP_HOME%\share\hadoop\yarn\*;%HADOOP_HOME%\share\hadoop\yarn\lib\*" WordCount.java
```

‚úî This creates:

```
WordCount.class
WordCount$TokenizerMapper.class
WordCount$IntSumReducer.class
```

---

# 6Ô∏è‚É£ Create JAR file

```bat
jar -cvf wordcount.jar *.class
```

Verify:

```bat
dir
```

You should see:

```
wordcount.jar
```

---

### Run WordCount using Hadoop

```bat
hadoop jar wordcount.jar WordCount /input /output
```

‚ö†Ô∏è If `/output` exists, delete it first:

```bat
hdfs dfs -rm -r /output
```

---

# 7Ô∏è‚É£ Validate Output

### üîπ View output files

```bat
hdfs dfs -ls /output
```

You‚Äôll see:

```
part-r-00000
_SUCCESS
```

### üîπ Display word count result

```bat
hdfs dfs -cat /output/part-r-00000
```

### ‚úÖ Sample Output

```
Hadoop    3
MapReduce 2
Java      1
```

---
